from collections.abc import Sequence
from datetime import datetime

from rateslib.dual import DualTypes, Number
from rateslib.dual.variable import Arr1dF64, Arr2dF64

class ADOrder:
    Zero: ADOrder
    One: ADOrder
    Two: ADOrder

class Convention:
    Act365F: Convention
    Act365FPlus: Convention
    Act360: Convention
    Thirty360: Convention
    ThirtyE360: Convention
    Thirty360ISDA: Convention
    ActActISDA: Convention
    ActActICMA: Convention
    One: Convention
    OnePlus: Convention
    Bus252: Convention

class Modifier:
    P: Modifier
    F: Modifier
    ModP: Modifier
    ModF: Modifier
    Act: Modifier

class RollDay:
    @classmethod
    def EoM(cls) -> RollDay: ...
    @classmethod
    def SoM(cls) -> RollDay: ...
    @classmethod
    def IMM(cls) -> RollDay: ...
    @classmethod
    def Int(cls, val: int) -> RollDay: ...
    @classmethod
    def Unspecified(cls) -> RollDay: ...

class Cal:
    def __init__(self, rules: list[datetime], weekmask: list[int]) -> None: ...
    def add_bus_days(self, date: datetime, days: int, settlement: bool) -> datetime: ...
    def add_days(
        self, date: datetime, days: int, modifier: Modifier, settlement: bool
    ) -> datetime: ...
    def add_months(
        self, date: datetime, months: int, modifier: Modifier, roll: RollDay, settlement: bool
    ) -> datetime: ...
    def bus_date_range(self, start: datetime, end: datetime) -> list[datetime]: ...
    def cal_date_range(self, start: datetime, end: datetime) -> list[datetime]: ...
    def is_bus_day(self, date: datetime) -> bool: ...
    def is_non_bus_day(self, date: datetime) -> bool: ...
    def is_settlement(self, date: datetime) -> bool: ...
    def lag(self, date: datetime, days: int, settlement: bool) -> datetime: ...
    def roll(self, date: datetime, modifier: Modifier, settlement: bool) -> datetime: ...
    def to_json(self) -> str: ...

class UnionCal:
    def __init__(
        self,
        calendars: list[Cal | NamedCal | UnionCal],
        settlement_calendars: list[Cal | NamedCal | UnionCal] | None,
    ) -> None: ...
    def add_bus_days(self, date: datetime, days: int, settlement: bool) -> datetime: ...
    def add_days(
        self, date: datetime, days: int, modifier: Modifier, settlement: bool
    ) -> datetime: ...
    def add_months(
        self, date: datetime, months: int, modifier: Modifier, roll: RollDay, settlement: bool
    ) -> datetime: ...
    def bus_date_range(self, start: datetime, end: datetime) -> list[datetime]: ...
    def cal_date_range(self, start: datetime, end: datetime) -> list[datetime]: ...
    def is_bus_day(self, date: datetime) -> bool: ...
    def is_non_bus_day(self, date: datetime) -> bool: ...
    def is_settlement(self, date: datetime) -> bool: ...
    def lag(self, date: datetime, days: int, settlement: bool) -> datetime: ...
    def roll(self, date: datetime, modifier: Modifier, settlement: bool) -> datetime: ...
    def to_json(self) -> str: ...

class NamedCal:
    def __init__(self, name: str) -> None: ...
    def add_bus_days(self, date: datetime, days: int, settlement: bool) -> datetime: ...
    def add_days(
        self, date: datetime, days: int, modifier: Modifier, settlement: bool
    ) -> datetime: ...
    def add_months(
        self, date: datetime, months: int, modifier: Modifier, roll: RollDay, settlement: bool
    ) -> datetime: ...
    def bus_date_range(self, start: datetime, end: datetime) -> list[datetime]: ...
    def cal_date_range(self, start: datetime, end: datetime) -> list[datetime]: ...
    def is_bus_day(self, date: datetime) -> bool: ...
    def is_non_bus_day(self, date: datetime) -> bool: ...
    def is_settlement(self, date: datetime) -> bool: ...
    def lag(self, date: datetime, days: int, settlement: bool) -> datetime: ...
    def roll(self, date: datetime, modifier: Modifier, settlement: bool) -> datetime: ...
    def to_json(self) -> str: ...

class Ccy:
    def __init__(self, name: str) -> None: ...
    name: str = ...

class FXRate:
    def __init__(
        self, lhs: str, rhs: str, rate: DualTypes, settlement: datetime | None
    ) -> None: ...
    rate: DualTypes = ...
    ad: int = ...
    settlement: datetime = ...
    pair: str = ...
    def __repr__(self) -> str: ...
    def __eq__(self, other: FXRate) -> bool: ...

class FXRates:
    def __init__(self, fx_rates: list[FXRate], base: Ccy | None) -> None: ...
    def __copy__(self) -> FXRates: ...
    fx_rates: list[FXRate] = ...
    currencies: list[Ccy] = ...
    ad: int = ...
    base: Ccy = ...
    fx_vector: list[DualTypes] = ...
    fx_array: list[list[DualTypes]] = ...
    def get_ccy_index(self, currency: Ccy) -> int | None: ...
    def rate(self, lhs: Ccy, rhs: Ccy) -> DualTypes | None: ...
    def update(self, fx_rates: list[FXRate]) -> None: ...
    def set_ad_order(self, ad: ADOrder) -> None: ...
    def to_json(self) -> str: ...

class Dual:
    def __init__(self, real: float, vars: Sequence[str], dual: Sequence[float] | Arr1dF64): ...
    real: float = ...
    vars: list[str] = ...
    dual: Arr1dF64 = ...
    @classmethod
    def vars_from(
        cls, other: Dual, real: float, vars: Sequence[str], dual: Sequence[float] | Arr1dF64
    ) -> Dual: ...
    def grad1(self, vars: list[str]) -> Arr1dF64: ...
    def grad2(self, vars: list[str]) -> Arr2dF64: ...
    def ptr_eq(self, other: Dual) -> bool: ...
    def __repr__(self) -> str: ...
    def __eq__(self, other: Number) -> bool: ...
    def __lt__(self, other: Number) -> bool: ...
    def __le__(self, other: Number) -> bool: ...
    def __gt__(self, other: Number) -> bool: ...
    def __ge__(self, other: Number) -> bool: ...
    def __neg__(self) -> Dual: ...
    def __add__(self, other: Number) -> Dual: ...
    def __radd__(self, other: Number) -> Dual: ...
    def __sub__(self, other: Number) -> Dual: ...
    def __rsub__(self, other: Number) -> Dual: ...
    def __mul__(self, other: Number) -> Dual: ...
    def __rmul__(self, other: Number) -> Dual: ...
    def __truediv__(self, other: Number) -> Dual: ...
    def __rtruediv__(self, other: Number) -> Dual: ...
    def __pow__(self, power: Number, modulo: int | None = None) -> Dual: ...
    def __exp__(self) -> Dual: ...
    def __abs__(self) -> float: ...
    def __log__(self) -> Dual: ...
    def __norm_cdf__(self) -> Dual: ...
    def __norm_inv_cdf__(self) -> Dual: ...
    def __float__(self) -> float: ...
    def to_json(self) -> str: ...
    def to_dual2(self) -> Dual2: ...

class Dual2:
    def __init__(
        self,
        real: float,
        vars: Sequence[str],
        dual: Sequence[float] | Arr1dF64,
        dual2: Sequence[float],
    ): ...
    real: float = ...
    vars: list[str] = ...
    dual: Arr1dF64 = ...
    dual2: Arr2dF64 = ...
    @classmethod
    def vars_from(
        cls,
        other: Dual2,
        real: float,
        vars: list[str],
        dual: list[float] | Arr1dF64,
        dual2: list[float] | Arr1dF64,
    ) -> Dual2: ...
    def grad1(self, vars: Sequence[str]) -> Arr1dF64: ...
    def gra1_manifold(self, vars: Sequence[str]) -> list[Dual2]: ...
    def grad2(self, vars: list[str]) -> Arr2dF64: ...
    def ptr_eq(self, other: Dual2) -> bool: ...
    def __repr__(self) -> str: ...
    def __eq__(self, other: Number) -> bool: ...
    def __lt__(self, other: Number) -> bool: ...
    def __le__(self, other: Number) -> bool: ...
    def __gt__(self, other: Number) -> bool: ...
    def __ge__(self, other: Number) -> bool: ...
    def __neg__(self) -> Dual2: ...
    def __add__(self, other: Number) -> Dual2: ...
    def __radd__(self, other: Number) -> Dual2: ...
    def __sub__(self, other: Number) -> Dual2: ...
    def __rsub__(self, other: Number) -> Dual2: ...
    def __mul__(self, other: Number) -> Dual2: ...
    def __rmul__(self, other: Number) -> Dual2: ...
    def __truediv__(self, other: Number) -> Dual2: ...
    def __rtruediv__(self, other: Number) -> Dual2: ...
    def __pow__(self, power: Number, modulo: int | None = None) -> Dual2: ...
    def __exp__(self) -> Dual2: ...
    def __abs__(self) -> float: ...
    def __log__(self) -> Dual2: ...
    def __norm_cdf__(self) -> Dual2: ...
    def __norm_inv_cdf__(self) -> Dual2: ...
    def __float__(self) -> float: ...
    def to_json(self) -> str: ...
    def to_dual(self) -> Dual: ...
